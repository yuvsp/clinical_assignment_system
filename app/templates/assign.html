{% extends "base.html" %}

{% block content %}
<h1 class="mb-4">Assign Instructor to {{ student.name }}</h1>
<form method="post">
    <table class="table table-bordered">
        <thead class="thead-light">
            <tr>
                <th>Instructor Name</th>
                <th>Area of Expertise</th>
                <th>Available Day</th>
                <th>Remark</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% set assignment_count = student.assignments|length %}
            {% for instructor, day, assignment, student_already_assigned_to_instructor in relevant_instructor_days %}
            <tr class="table-success">
                <td>{{ instructor.name }}</td>
                <td>{{ instructor.area_of_expertise.name }} [{{ instructor.practice_location }}]</td>
                <td>{{ day }}</td>
                <td>
                    {% if day in student_assigned_days %}
                    Student already has assignment on this day
                    {% endif %}
                </td>
                <td>
                    {% if assignment and student_already_assigned_to_instructor %}
                    <button type="submit" name="cancel_assignment_id" value="{{ assignment.id }}" class="btn btn-danger">Cancel Assignment</button>
                    {% elif assignment_count < 3 %}
                    <button type="submit" name="instructor_id" value="{{ instructor.id }}" onclick="document.getElementById('assigned_day').value='{{ day }}'" class="btn btn-primary">Assign</button>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
            {% for instructor, day, reason in irrelevant_instructors %}
            <tr class="{% if reason == 'Field is not relevant' %}table-warning{% else %}table-danger{% endif %}">
                <td style="text-decoration: line-through;">{{ instructor.name }}</td>
                <td style="text-decoration: line-through;">{{ instructor.area_of_expertise.name }} [{{ instructor.practice_location }}]</td>
                <td style="text-decoration: line-through;">{{ day }}</td>
                <td>{{ reason }}</td>
                <td>
                    {% if reason == 'Field is not relevant' and assignment_count < 3 %}
                    <button type="submit" name="instructor_id" value="{{ instructor.id }}" onclick="document.getElementById('assigned_day').value='{{ day }}'" class="btn btn-primary">Assign</button>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <input type="hidden" id="assigned_day" name="assigned_day">
</form>
{% endblock %}
